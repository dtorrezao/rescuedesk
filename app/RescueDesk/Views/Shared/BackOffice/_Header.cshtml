@using RescueDesk.Utils
@using RescueDesk.ViewModels
<header id="header" class="header">
    <div class="header-menu">
        <div class="col-sm-7">
            <a id="menuToggle" class="menutoggle pull-left"><i class="fa fa fa-align-justify"></i></a>
            <div class="header-left">
                <button class="search-trigger"><i class="fa fa-search"></i></button>
                <div class="form-inline">
                    <form class="search-form">
                        <input class="form-control mr-sm-2" type="text" placeholder="Search ..." aria-label="Search">
                        <button class="search-close" type="submit"><i class="fa fa-close"></i></button>
                    </form>
                </div>                
                <div class="dropdown for-message">
                    <button class="btn btn-secondary dropdown-toggle" type="button"
                            id="message"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="ti-email"></i>
                        <span class="count bg-primary">@ViewHelper.ObterContagemMensagens()</span>
                    </button>
                    <div class="dropdown-menu" aria-labelledby="message">
                        <p class="red">Tem @ViewHelper.ObterContagemMensagens() Mensagens</p>
                        @foreach (var item in ViewHelper.ObterMensagens(5))
                        {
                            <a class="dropdown-item media bg-flat-color-1 modal-link" href="@Url.Action("Details","Mensagens",new { id = item.Link })">
                                <span class="photo media-left"><img class="rounded-circle mx-auto d-block" src="@item.Utilizador.foto"></span>
                                <span class="message media-body">
                                    <span class="name float-left">@item.Utilizador.nome</span>
                                    <span class="time float-right">@item.DataEnviada</span>
                                    <p>@item.Assunto</p>
                                </span>
                            </a>
                        }
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-5">
            <div class="user-area dropdown float-right">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <img class="user-avatar rounded-circle" src="@RescueDesk.Utils.ViewHelper.GetUserImage()" alt="User Avatar">
                </a>
                <div class="user-menu dropdown-menu">
                    <a class="nav-link modal-link" href="@Url.Action("Perfil", "Utilizadores")"><i class="fa fa- user"></i>Meu Perfil</a>
                    <a class="nav-link" href="@Url.Action("Logoff","Utilizadores")"><i class="fa fa-power- off"></i>Sair</a>
                </div>
            </div>

        </div>
    </div>
</header>